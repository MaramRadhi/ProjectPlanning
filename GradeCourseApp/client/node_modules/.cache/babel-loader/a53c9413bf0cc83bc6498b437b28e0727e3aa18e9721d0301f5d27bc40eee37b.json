{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nimport { useEffect, useRef, useCallback } from 'react';\nimport debounce from 'lodash/debounce';\nimport isEqual from 'lodash/isEqual';\nimport { useSafeSetState } from '../util';\nvar defaultFilterToQuery = function (v) {\n  return {\n    q: v\n  };\n};\n/**\n * Hooks to provide filter state and setFilter which update the query part of the filter\n *\n * @example\n *\n * const { filter, setFilter } = useFilter({\n *      filterToQuery: v => ({ query: v }),\n *      permanentFilter: { foo: 'bar' },\n *      debounceTime: 500,\n * });\n * // filter initial value:\n * {\n *      query: '',\n *      foo: 'bar'\n * }\n *  // after updating filter\n *  setFilter('needle');\n *  {\n *      query: 'needle',\n *      foo: 'bar'\n *  }\n *\n * @param {Object} option\n * @param {Function} option.filterToQuery Function to convert the filter string to a filter object. Defaults to v => ({ q: v }).\n * @param {Object} option.permanentFilter Permanent filter to be merged with the filter string. Defaults to {}.\n * @param {number} option.debounceTime Time in ms between filter updates - used to debounce the search. Defaults to 500ms.\n *\n * @returns {UseFilterStateOptions} The filter props\n */\nexport default (function (_a) {\n  var _b = _a.filterToQuery,\n    filterToQuery = _b === void 0 ? defaultFilterToQuery : _b,\n    _c = _a.permanentFilter,\n    permanentFilter = _c === void 0 ? {} : _c,\n    _d = _a.debounceTime,\n    debounceTime = _d === void 0 ? 500 : _d;\n  var permanentFilterProp = useRef(permanentFilter);\n  var latestValue = useRef();\n  var _e = useSafeSetState(__assign(__assign({}, permanentFilter), filterToQuery(''))),\n    filter = _e[0],\n    setFilterValue = _e[1];\n  // Developers often pass an object literal as permanent filter\n  // e.g. <ReferenceInput source=\"book_id\" reference=\"books\" filter={{ is_published: true }}>\n  // The effect should execute again when the parent component updates the filter value,\n  // but not when the object literal describes the same values. Therefore,\n  // we use JSON.stringify(permanentFilter) in the `useEffect` and `useCallback`\n  // dependencies instead of permanentFilter.\n  var permanentFilterSignature = JSON.stringify(permanentFilter);\n  useEffect(function () {\n    if (!isEqual(permanentFilterProp.current, permanentFilter)) {\n      permanentFilterProp.current = permanentFilter;\n      setFilterValue(__assign(__assign({}, permanentFilter), filterToQuery(latestValue.current)));\n    }\n  }, [permanentFilterSignature, permanentFilterProp, filterToQuery]); // eslint-disable-line react-hooks/exhaustive-deps\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  var setFilter = useCallback(debounce(function (value) {\n    setFilterValue(__assign(__assign({}, permanentFilter), filterToQuery(value)));\n    latestValue.current = value;\n  }, debounceTime), [permanentFilterSignature] // eslint-disable-line react-hooks/exhaustive-deps\n  );\n\n  return {\n    filter: filter,\n    setFilter: setFilter\n  };\n});","map":{"version":3,"names":["useEffect","useRef","useCallback","debounce","isEqual","useSafeSetState","defaultFilterToQuery","v","q","_a","_b","filterToQuery","_c","permanentFilter","_d","debounceTime","permanentFilterProp","latestValue","_e","__assign","filter","setFilterValue","permanentFilterSignature","JSON","stringify","current","setFilter","value"],"sources":["/Users/imrun10/Documents/GitHub/GradeCourseApp/client/node_modules/ra-core/src/controller/useFilterState.ts"],"sourcesContent":["import { useEffect, useRef, useCallback } from 'react';\nimport debounce from 'lodash/debounce';\nimport isEqual from 'lodash/isEqual';\n\nimport { useSafeSetState } from '../util';\nimport { FilterPayload } from '../types';\n\ninterface UseFilterStateOptions {\n    filterToQuery?: (v: string) => FilterPayload;\n    permanentFilter?: FilterPayload;\n    debounceTime?: number;\n}\n\n/**\n * @typedef UseFilterStateProps\n * @property {Object} filter: The filter object.\n * @property {setFilter} setFilter: Update the filter with the given string\n */\ninterface UseFilterStateProps {\n    filter: FilterPayload;\n    setFilter: (v: string) => void;\n}\n\nconst defaultFilterToQuery = (v: string) => ({ q: v });\n\n/**\n * Hooks to provide filter state and setFilter which update the query part of the filter\n *\n * @example\n *\n * const { filter, setFilter } = useFilter({\n *      filterToQuery: v => ({ query: v }),\n *      permanentFilter: { foo: 'bar' },\n *      debounceTime: 500,\n * });\n * // filter initial value:\n * {\n *      query: '',\n *      foo: 'bar'\n * }\n *  // after updating filter\n *  setFilter('needle');\n *  {\n *      query: 'needle',\n *      foo: 'bar'\n *  }\n *\n * @param {Object} option\n * @param {Function} option.filterToQuery Function to convert the filter string to a filter object. Defaults to v => ({ q: v }).\n * @param {Object} option.permanentFilter Permanent filter to be merged with the filter string. Defaults to {}.\n * @param {number} option.debounceTime Time in ms between filter updates - used to debounce the search. Defaults to 500ms.\n *\n * @returns {UseFilterStateOptions} The filter props\n */\nexport default ({\n    filterToQuery = defaultFilterToQuery,\n    permanentFilter = {},\n    debounceTime = 500,\n}: UseFilterStateOptions): UseFilterStateProps => {\n    const permanentFilterProp = useRef(permanentFilter);\n    const latestValue = useRef<string>();\n    const [filter, setFilterValue] = useSafeSetState({\n        ...permanentFilter,\n        ...filterToQuery(''),\n    });\n    // Developers often pass an object literal as permanent filter\n    // e.g. <ReferenceInput source=\"book_id\" reference=\"books\" filter={{ is_published: true }}>\n    // The effect should execute again when the parent component updates the filter value,\n    // but not when the object literal describes the same values. Therefore,\n    // we use JSON.stringify(permanentFilter) in the `useEffect` and `useCallback`\n    // dependencies instead of permanentFilter.\n    const permanentFilterSignature = JSON.stringify(permanentFilter);\n\n    useEffect(() => {\n        if (!isEqual(permanentFilterProp.current, permanentFilter)) {\n            permanentFilterProp.current = permanentFilter;\n            setFilterValue({\n                ...permanentFilter,\n                ...filterToQuery(latestValue.current),\n            });\n        }\n    }, [permanentFilterSignature, permanentFilterProp, filterToQuery]); // eslint-disable-line react-hooks/exhaustive-deps\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    const setFilter = useCallback(\n        debounce((value: string) => {\n            setFilterValue({\n                ...permanentFilter,\n                ...filterToQuery(value),\n            });\n            latestValue.current = value;\n        }, debounceTime),\n        [permanentFilterSignature] // eslint-disable-line react-hooks/exhaustive-deps\n    );\n\n    return {\n        filter,\n        setFilter,\n    };\n};\n"],"mappings":";;;;;;;;;;AAAA,SAASA,SAAS,EAAEC,MAAM,EAAEC,WAAW,QAAQ,OAAO;AACtD,OAAOC,QAAQ,MAAM,iBAAiB;AACtC,OAAOC,OAAO,MAAM,gBAAgB;AAEpC,SAASC,eAAe,QAAQ,SAAS;AAmBzC,IAAMC,oBAAoB,GAAG,SAAAA,CAACC,CAAS;EAAK,OAAC;IAAEC,CAAC,EAAED;EAAC,CAAE;AAAT,CAAU;AAEtD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6BA,gBAAe,UAACE,EAIQ;MAHpBC,EAAA,GAAAD,EAAA,CAAAE,aAAoC;IAApCA,aAAa,GAAAD,EAAA,cAAGJ,oBAAoB,GAAAI,EAAA;IACpCE,EAAA,GAAAH,EAAA,CAAAI,eAAoB;IAApBA,eAAe,GAAAD,EAAA,cAAG,EAAE,GAAAA,EAAA;IACpBE,EAAA,GAAAL,EAAA,CAAAM,YAAkB;IAAlBA,YAAY,GAAAD,EAAA,cAAG,GAAG,GAAAA,EAAA;EAElB,IAAME,mBAAmB,GAAGf,MAAM,CAACY,eAAe,CAAC;EACnD,IAAMI,WAAW,GAAGhB,MAAM,EAAU;EAC9B,IAAAiB,EAAA,GAA2Bb,eAAe,CAAAc,QAAA,CAAAA,QAAA,KACzCN,eAAe,GACfF,aAAa,CAAC,EAAE,CAAC,EACtB;IAHKS,MAAM,GAAAF,EAAA;IAAEG,cAAc,GAAAH,EAAA,GAG3B;EACF;EACA;EACA;EACA;EACA;EACA;EACA,IAAMI,wBAAwB,GAAGC,IAAI,CAACC,SAAS,CAACX,eAAe,CAAC;EAEhEb,SAAS,CAAC;IACN,IAAI,CAACI,OAAO,CAACY,mBAAmB,CAACS,OAAO,EAAEZ,eAAe,CAAC,EAAE;MACxDG,mBAAmB,CAACS,OAAO,GAAGZ,eAAe;MAC7CQ,cAAc,CAAAF,QAAA,CAAAA,QAAA,KACPN,eAAe,GACfF,aAAa,CAACM,WAAW,CAACQ,OAAO,CAAC,EACvC;;EAEV,CAAC,EAAE,CAACH,wBAAwB,EAAEN,mBAAmB,EAAEL,aAAa,CAAC,CAAC,CAAC,CAAC;EAEpE;EACA,IAAMe,SAAS,GAAGxB,WAAW,CACzBC,QAAQ,CAAC,UAACwB,KAAa;IACnBN,cAAc,CAAAF,QAAA,CAAAA,QAAA,KACPN,eAAe,GACfF,aAAa,CAACgB,KAAK,CAAC,EACzB;IACFV,WAAW,CAACQ,OAAO,GAAGE,KAAK;EAC/B,CAAC,EAAEZ,YAAY,CAAC,EAChB,CAACO,wBAAwB,CAAC,CAAC;EAAA,CAC9B;;EAED,OAAO;IACHF,MAAM,EAAAA,MAAA;IACNM,SAAS,EAAAA;GACZ;AACL,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}