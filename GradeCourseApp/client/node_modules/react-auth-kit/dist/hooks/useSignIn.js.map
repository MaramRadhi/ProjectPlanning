{"version":3,"file":"useSignIn.js","sources":["../../src/hooks/useSignIn.ts"],"sourcesContent":["/**\n *@author Arkadip Bhattacharya <in2arkadipb13@gmail.com>\n *@fileoverview Sign In functionality <hook>\n *@copyright Arkadip Bhattacharya 2020\n *@license Apache-2.0\n *\n * Copyright 2020 Arkadip Bhattacharya\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *         http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as React from 'react';\nimport AuthContext from '../AuthContext';\nimport {signInFunctionParams} from '../types';\nimport {doSignIn} from '../utils/reducers';\nimport {AuthKitError} from '../errors';\n\n/**\n *@function\n *@name useSignIn\n *@description Authentication SignIn Hook\n *@returns - Sign In function\n */\nfunction useSignIn(): (signInConfig: signInFunctionParams) => boolean {\n  const context = React.useContext(AuthContext);\n  if (context === null) {\n    throw new\n    AuthKitError('Auth Provider is missing. ' +\n      'Please add the AuthProvider before Router');\n  }\n  return (signInConfig: signInFunctionParams): boolean => {\n    const {\n      token,\n      tokenType,\n      authState,\n      expiresIn,\n      refreshToken,\n      refreshTokenExpireIn,\n    } = signInConfig;\n    const expTime = new Date(new Date().getTime() + expiresIn * 60 * 1000);\n    if (context.authState.isUsingRefreshToken) {\n      // Using the power of refresh token\n      if (!!refreshToken && !!refreshTokenExpireIn) {\n        // refresh token params are provided\n        // sign in with refresh token\n        const refreshTokenExpireAt =\n          new Date(new Date().getTime() + refreshTokenExpireIn * 60 * 1000);\n        context.dispatch(doSignIn({\n          auth: {\n            token: token,\n            type: tokenType,\n            expiresAt: expTime,\n          },\n          userState: authState ? authState : null,\n          refresh: {\n            token: refreshToken,\n            expiresAt: refreshTokenExpireAt,\n          },\n        }));\n        return true;\n      } else {\n        // refresh token params are not provided\n        // throw an error\n        throw new AuthKitError('Make sure you given \"refreshToken\" and  ' +\n          '\"refreshTokenExpireIn\" parameter');\n      }\n    } else {\n      // Not using refresh token\n      if (!!refreshToken && !!refreshTokenExpireIn) {\n        // params are not expected but provided\n        // throw an error\n        throw new Error('The app doesn\\'t implement \\'refreshToken\\' ' +\n          'feature.\\nSo you have to implement refresh token feature ' +\n          'from \\'AuthProvider\\' before using it.');\n      } else {\n        // sign in without the refresh token\n        context.dispatch(doSignIn({\n          auth: {\n            token: token,\n            type: tokenType,\n            expiresAt: expTime,\n          },\n          userState: authState ? authState : null,\n          refresh: null,\n        }));\n        return true;\n      }\n    }\n  };\n}\n\n/**\n *@exports useSignIn\n */\nexport default useSignIn;\n"],"names":[],"mappings":";;;;;AAAA;;;;;;;;;;;;;;;;;;;AAmBG;AAQH;;;;;AAKG;AACH,SAAS,SAAS,GAAA;IAChB,IAAM,OAAO,GAAG,KAAK,CAAC,UAAU,CAAC,WAAW,CAAC,CAAC;IAC9C,IAAI,OAAO,KAAK,IAAI,EAAE;QACpB,MAAM,IACN,YAAY,CAAC,4BAA4B;AACvC,YAAA,2CAA2C,CAAC,CAAC;AAChD,KAAA;AACD,IAAA,OAAO,UAAC,YAAkC,EAAA;AAEtC,QAAA,IAAA,KAAK,GAMH,YAAY,CAAA,KANT,EACL,SAAS,GAKP,YAAY,CALL,SAAA,EACT,SAAS,GAIP,YAAY,CAAA,SAJL,EACT,SAAS,GAGP,YAAY,CAHL,SAAA,EACT,YAAY,GAEV,YAAY,CAAA,YAFF,EACZ,oBAAoB,GAClB,YAAY,qBADM,CACL;AACjB,QAAA,IAAM,OAAO,GAAG,IAAI,IAAI,CAAC,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,GAAG,SAAS,GAAG,EAAE,GAAG,IAAI,CAAC,CAAC;AACvE,QAAA,IAAI,OAAO,CAAC,SAAS,CAAC,mBAAmB,EAAE;;AAEzC,YAAA,IAAI,CAAC,CAAC,YAAY,IAAI,CAAC,CAAC,oBAAoB,EAAE;;;AAG5C,gBAAA,IAAM,oBAAoB,GACxB,IAAI,IAAI,CAAC,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,GAAG,oBAAoB,GAAG,EAAE,GAAG,IAAI,CAAC,CAAC;AACpE,gBAAA,OAAO,CAAC,QAAQ,CAAC,QAAQ,CAAC;AACxB,oBAAA,IAAI,EAAE;AACJ,wBAAA,KAAK,EAAE,KAAK;AACZ,wBAAA,IAAI,EAAE,SAAS;AACf,wBAAA,SAAS,EAAE,OAAO;AACnB,qBAAA;oBACD,SAAS,EAAE,SAAS,GAAG,SAAS,GAAG,IAAI;AACvC,oBAAA,OAAO,EAAE;AACP,wBAAA,KAAK,EAAE,YAAY;AACnB,wBAAA,SAAS,EAAE,oBAAoB;AAChC,qBAAA;AACF,iBAAA,CAAC,CAAC,CAAC;AACJ,gBAAA,OAAO,IAAI,CAAC;AACb,aAAA;AAAM,iBAAA;;;gBAGL,MAAM,IAAI,YAAY,CAAC,0CAA0C;AAC/D,oBAAA,kCAAkC,CAAC,CAAC;AACvC,aAAA;AACF,SAAA;AAAM,aAAA;;AAEL,YAAA,IAAI,CAAC,CAAC,YAAY,IAAI,CAAC,CAAC,oBAAoB,EAAE;;;gBAG5C,MAAM,IAAI,KAAK,CAAC,8CAA8C;oBAC5D,2DAA2D;AAC3D,oBAAA,wCAAwC,CAAC,CAAC;AAC7C,aAAA;AAAM,iBAAA;;AAEL,gBAAA,OAAO,CAAC,QAAQ,CAAC,QAAQ,CAAC;AACxB,oBAAA,IAAI,EAAE;AACJ,wBAAA,KAAK,EAAE,KAAK;AACZ,wBAAA,IAAI,EAAE,SAAS;AACf,wBAAA,SAAS,EAAE,OAAO;AACnB,qBAAA;oBACD,SAAS,EAAE,SAAS,GAAG,SAAS,GAAG,IAAI;AACvC,oBAAA,OAAO,EAAE,IAAI;AACd,iBAAA,CAAC,CAAC,CAAC;AACJ,gBAAA,OAAO,IAAI,CAAC;AACb,aAAA;AACF,SAAA;AACH,KAAC,CAAC;AACJ;;;;"}